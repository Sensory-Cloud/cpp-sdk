<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SensoryCloud C++ SDK: Tutorial</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="html_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">SensoryCloud C++ SDK
                                &#160;<span id="projectnumber">1.0.8</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The tutorial provides an overview of the <a href="https://sensorycloud.ai/">SensoryCloud</a> C++ SDK. This tutorial will show you how to:</p>
<ul>
<li>setup a C++ project and include the <a href="https://sensorycloud.ai/">SensoryCloud</a> C++ SDK in your build,</li>
<li>implement secure credential storage and connect to your inference server,</li>
<li>query the server's health, and</li>
<li>navigate the <a href="https://sensorycloud.ai/">SensoryCloud</a> example projects.</li>
</ul>
<p >Because this SDK is built on <a href="https://www.grpc.io/">gRPC</a>, you may benefit from referring to the <a href="https://www.grpc.io/docs/languages/cpp/basics/">gRPC Tutorial</a> and <a href="https://grpc.github.io/grpc/cpp/annotated.html">gRPC Documentation</a> to familiarize yourself with some of the gRPC structures and patterns that are used in this SDK and tutorial.</p>
<h1>Project Setup</h1>
<p >The recommended build system for projects based on this SDK is <a href="https://cmake.org/"><code>cmake</code></a>. To include the SDK in your project , the simplest solution is to add a <code>FetchContent</code> block to your <code>CMakeLists.txt</code>. This approach will compile and link the protobuff and gRPC dependencies locally. Below is an example of the boilerplate CMake syntax to include the SDK in your project.</p>
<div class="fragment"><div class="line">project(your-project-name)</div>
<div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line">set(CMAKE_CXX_STANDARD 11)</div>
<div class="line"> </div>
<div class="line">include(FetchContent)</div>
<div class="line">FetchContent_Declare(sensorycloud</div>
<div class="line">    URL https://codeload.github.com/Sensory-Cloud/cpp-sdk/tar.gz/refs/tags/v1.0.8</div>
<div class="line">)</div>
<div class="line">FetchContent_MakeAvailable(sensorycloud)</div>
<div class="line"> </div>
<div class="line"># ...</div>
<div class="line"> </div>
<div class="line"># Define an executable and link with libsensorycloud.</div>
<div class="line">add_executable(hello_cloud hello_cloud.cpp)</div>
<div class="line">target_link_libraries(hello_cloud PRIVATE sensorycloud)</div>
</div><!-- fragment --><h4>Header files</h4>
<p >The SDK definition is funneled down to a single header file for the most common elements of the SDK. In most cases, you will only need the following include statement to get started with the SDK.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;sensorycloud/sensorycloud.hpp&gt;</div>
</div><!-- fragment --><h1>Credential Storage</h1>
<p >The first piece you will need to set up for your application is a structure for storing and persisting credentials in a way that fits your security needs. The <code>MyCredentialStore</code> structure below provides the interface for credential storage that should be implemented for your specific usage. This structure behaves like a C++ map, but should persist key-value data between executions of your application. This implementation follows C++ syntax for <code>map</code> structures and may be trivially compatible with your existing solution for secure key-value storage. It is worth noting that the SDK's usage of this structure is based on templates, so there is no need to inherit from a base class to implement this component.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">struct MyCredentialStore {</div>
<div class="line">    /// @brief Emplace or overwrite a key/value pair in the credential store.</div>
<div class="line">    /// @param key the plain-text key of the value to store</div>
<div class="line">    /// @param value the value to store</div>
<div class="line">    inline void emplace(const std::string&amp; key, const std::string&amp; value) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Return true if the key exists in the credential store.</div>
<div class="line">    /// @param key the plain-text key to check for the existence of</div>
<div class="line">    inline bool contains(const std::string&amp; key) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Look-up a secret value in the credential store.</div>
<div class="line">    /// @param key the plain-text key of the value to return</div>
<div class="line">    /// @returns the secret value indexed by the given key</div>
<div class="line">    inline std::string at(const std::string&amp; key) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Remove a secret key-value pair in the credential store.</div>
<div class="line">    /// @param key the key of the pair to remove from the credential store</div>
<div class="line">    inline void erase(const std::string&amp; key) const;</div>
<div class="line">};</div>
</div><!-- fragment --><p >Included with the SDK are some debugging implementations of this interface that may be useful for your testing and/or applications. <code><a class="el" href="classsensory_1_1token__manager_1_1_file_system_credential_store.html" title="A file-systemâ€“based credential storage manager.">sensory::token_manager::FileSystemCredentialStore</a></code> provides an implementation based on the file-system that may be useful for low-security applications, demonstration purposes, or debugging. We also provide a <code><a class="el" href="structsensory_1_1token__manager_1_1_in_memory_credential_store.html" title="An in-memory credential store (mostly for testing purposes).">sensory::token_manager::InMemoryCredentialStore</a></code> that may be useful for integrating SensoryCloud with your unit tests. The in-memory store can be instantiated without parameters, but the file-system based store must be provided with a path to a directory to persist data to and a prefix for files that are created in the file-system-based key-value store. For this example, we utilize the file-system credential store:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::token_manager::FileSystemCredentialStore</div>
<div class="line">    credential_store(&quot;.&quot;, &quot;com.company.cloud.debug&quot;);</div>
</div><!-- fragment --><h1>Configuring a connection</h1>
<p >There are two ways to configure your connection to SensoryCloud in code. At the lower level you may choose to hard-code your tenant metadata (or specify the parameters in the method of your choosing) using the <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> and <code><a class="el" href="structsensory_1_1_registration_credentials.html" title="A structure containing credentials for device registration.">sensory::RegistrationCredentials</a></code> structures. Alternatively you may choose to use the INI file provided by our sales team to configure your connection. Both of these connection APIs are discussed in the following sections.</p>
<h2>Hard-coded Config and RegistrationCredentials structures</h2>
<p >To connect to your inference server using a hard-coded config, you will need to know:</p>
<ol type="1">
<li>the host-name or IP address that the service is running at,</li>
<li>the specific port that the service is running at &ndash; typically <code>443</code>, &ndash;</li>
<li>your tenant ID that uniquely identifies your tenant in SensoryCloud, and</li>
<li>a way of uniquely identifying devices in your application.</li>
</ol>
<p >This information can be provided to the SDK using a <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> object:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::Config config(</div>
<div class="line">    &quot;example.company.com&quot;,                   // the host name of the server</div>
<div class="line">    443,                                     // the port number of the service</div>
<div class="line">    &quot;a376234e-5b4b-4acb-bdbc-8cac8c397ace&quot;,  // your tenant ID</div>
<div class="line">    &quot;4e07cce1-cccb-4630-a2d1-5da71e3c85a3&quot;,  // a unique device ID</div>
<div class="line">    true                                     // a flag for enabling TLS</div>
<div class="line">);</div>
</div><!-- fragment --><p >A single instance of <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> should be instantiated and maintained per instance of an application on a device when using this API. Using multiple instances of <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> for the same remote host may result in undefined behavior.</p>
<h4>Device Registration</h4>
<p >Devices in that interact with the inference server will need to register and be authenticated using cross-device trust. As such, each device will need to provide the following information when instantiating the SDK:</p>
<ol type="1">
<li>A name for the device for identifying it among the cluster of devices,</li>
</ol>
<ol type="1">
<li>The type of device enrollment to use, e.g., <code>sharedSecret</code> if your fleet uses "passphrase"-based authentication or <code>JWT</code> to use JSON web tokens, and</li>
</ol>
<ol type="1">
<li>The value for the credential which varies depending on your tenant.</li>
</ol>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::RegistrationCredentials credentials(</div>
<div class="line">    &quot;Server 1&quot;,      // A human-readable name for the device.</div>
<div class="line">    &quot;sharedSecret&quot;,  // The type of enrollment (&quot;sharedSecret&quot; or &quot;jwt&quot;).</div>
<div class="line">    &quot;password&quot;       // The value of the credential.</div>
<div class="line">);</div>
</div><!-- fragment --><h2>INI Files</h2>
<p >To simplify connection and device registration, the aforementioned information may be serialized in an INI file in the following format that describes your tenant in SensoryCloud:</p>
<div class="fragment"><div class="line">[SDK-configuration]</div>
<div class="line">fullyQualifiedDomainName = example.company.com:443</div>
<div class="line">tenantID = a376234e-5b4b-4acb-bdbc-8cac8c397ace</div>
<div class="line">credential = password</div>
<div class="line">enrollmentType = sharedSecret</div>
<div class="line">isSecure = 1</div>
</div><!-- fragment --><p >When you sign up for SensoryCloud, you will be provided with an INI file in the above format that you may use with our example code or for your own purposes. Note that when using INI files, device IDs and names are provided optionally through environment variables, i.e.,</p>
<div class="fragment"><div class="line">export SENSORYCLOUD_DEVICE_ID=4e07cce1-cccb-4630-a2d1-5da71e3c85a3</div>
<div class="line">export SENSORYCLOUD_DEVICE_NAME=&quot;Server 1&quot;</div>
</div><!-- fragment --><p >If either of the device name or the device ID are not provided, a random one will be generated and stored in the secure credential store. This allows for re-use of INI files between devices with the ability to track devices in your deployment explicitly, if needed.</p>
<h1>SDK Instantiation</h1>
<p >With the data structures defined in the previous steps, one can construct an instance of <code><a class="el" href="classsensory_1_1_sensory_cloud.html" title="The SensoryCloud service.">sensory::SensoryCloud</a></code> that provides access to each cloud service.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::SensoryCloud&lt;sensory::token_manager::FileSystemCredentialStore&gt;</div>
<div class="line">    cloud(config, credentials, credential_store);</div>
</div><!-- fragment --><p >As previously mentioned, config and registration credentials may optionally be stored in INI files and parsed on SDK initialization using the following where <code>./config.ini</code> is an example path to your tenant INI file.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::SensoryCloud&lt;sensory::token_manager::FileSystemCredentialStore&gt;</div>
<div class="line">    cloud(&quot;./config.ini&quot;, credential_store);</div>
</div><!-- fragment --><p ><em>Note that our example code uses the INI construction interface.</em></p>
<h1>Checking The Server Health</h1>
<p >Once you have a connection to SensoryCloud instantiated, it's important to check the health of your <a href="https://sensorycloud.ai/">SensoryCloud</a> inference server. You can do so using the <code>HealthService</code> via the following:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">// Create a response for the RPC.</div>
<div class="line">sensory::api::common::ServerHealthResponse response;</div>
<div class="line">// Perform the RPC and check the status for errors.</div>
<div class="line">auto status = cloud.health.get_health(&amp;response);</div>
<div class="line">if (!status.ok()) {  // The call failed, handle the error here.</div>
<div class="line">    auto error_code = status.error_code();</div>
<div class="line">    auto error_message = status.error_message();</div>
<div class="line">} else {  // The call succeeded, handle the response here.</div>
<div class="line">    std::cout &lt;&lt; &quot;Server is healthy: &quot; &lt;&lt; response.ishealthy() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h1>Example Projects</h1>
<p >At this point you should be set up and ready to integrate with SensoryCloud! The remainder of the tutorial is organized in a programmatic format through example code. Examples for each individual service may be found in the [examples](examples) directory.</p>
<h1>Full Code</h1>
<p >For your convenience, the above passages are condensed into the following code blocks for the two approaches for instantiating the SDK.</p>
<h2>Hard-coded config API</h2>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;sensorycloud/sensorycloud.hpp&gt;</div>
<div class="line">#include &lt;sensorycloud/token_manager/file_system_credential_store.hpp&gt;</div>
<div class="line"> </div>
<div class="line">int main() {</div>
<div class="line">    sensory::token_manager::FileSystemCredentialStore</div>
<div class="line">        credential_store(&quot;.&quot;, &quot;com.company.cloud.debug&quot;);</div>
<div class="line"> </div>
<div class="line">    sensory::Config config(</div>
<div class="line">        &quot;example.company.com&quot;,                   // the host name of the server</div>
<div class="line">        443,                                     // the port number of the service</div>
<div class="line">        &quot;a376234e-5b4b-4acb-bdbc-8cac8c397ace&quot;,  // your tenant ID</div>
<div class="line">        &quot;4e07cce1-cccb-4630-a2d1-5da71e3c85a3&quot;,  // a unique device ID</div>
<div class="line">        true                                     // a flag for enabling TLS</div>
<div class="line">    );</div>
<div class="line">    sensory::RegistrationCredentials credentials(</div>
<div class="line">        &quot;Server 1&quot;,      // A human-readable name for the device.</div>
<div class="line">        &quot;sharedSecret&quot;,  // The type of enrollment (&quot;sharedSecret&quot; or &quot;jwt&quot;).</div>
<div class="line">        &quot;password&quot;       // The value of the credential.</div>
<div class="line">    );</div>
<div class="line">    sensory::SensoryCloud&lt;sensory::token_manager::FileSystemCredentialStore&gt;</div>
<div class="line">        cloud(config, credentials, credential_store);</div>
<div class="line"> </div>
<div class="line">    sensory::api::common::ServerHealthResponse response;</div>
<div class="line">    auto status = cloud.health.get_health(&amp;response);</div>
<div class="line">    if (!status.ok()) {  // The call failed, handle the error here.</div>
<div class="line">        auto error_code = status.error_code();</div>
<div class="line">        auto error_message = status.error_message();</div>
<div class="line">    } else {  // The call succeeded, handle the response here.</div>
<div class="line">        std::cout &lt;&lt; &quot;Server is healthy: &quot; &lt;&lt; response.ishealthy() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2>INI file API</h2>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &lt;sensorycloud/sensorycloud.hpp&gt;</div>
<div class="line">#include &lt;sensorycloud/token_manager/file_system_credential_store.hpp&gt;</div>
<div class="line"> </div>
<div class="line">int main() {</div>
<div class="line">    sensory::token_manager::FileSystemCredentialStore</div>
<div class="line">        credential_store(&quot;.&quot;, &quot;com.company.cloud.debug&quot;);</div>
<div class="line">    sensory::SensoryCloud&lt;sensory::token_manager::FileSystemCredentialStore&gt;</div>
<div class="line">        cloud(&quot;./config.ini&quot;, credential_store);</div>
<div class="line"> </div>
<div class="line">    sensory::api::common::ServerHealthResponse response;</div>
<div class="line">    auto status = cloud.health.get_health(&amp;response);</div>
<div class="line">    if (!status.ok()) {  // The call failed, handle the error here.</div>
<div class="line">        auto error_code = status.error_code();</div>
<div class="line">        auto error_message = status.error_message();</div>
<div class="line">    } else {  // The call succeeded, handle the response here.</div>
<div class="line">        std::cout &lt;&lt; &quot;Server is healthy: &quot; &lt;&lt; response.ishealthy() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.18-->
<!-- start footer part -->
</body>
</html>
