<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SensoryCloud C++ SDK: Tutorial</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="html_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">SensoryCloud C++ SDK
                                &#160;<span id="projectnumber">1.0.4</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The tutorial provides an overview of the <a href="https://sensorycloud.ai/">SensoryCloud</a> C++ SDK. This tutorial will show you how to:</p>
<ul>
<li>setup a C++ project and include the <a href="https://sensorycloud.ai/">SensoryCloud</a> C++ SDK in your build,</li>
<li>implement secure credential storage and connect to your inference server,</li>
<li>query the server's health, and</li>
<li>navigate the <a href="https://sensorycloud.ai/">SensoryCloud</a> example projects.</li>
</ul>
<p >Because this SDK is built on <a href="https://www.grpc.io/">gRPC</a>, you may benefit from referring to the <a href="https://www.grpc.io/docs/languages/cpp/basics/">gRPC Tutorial</a> and <a href="https://grpc.github.io/grpc/cpp/annotated.html">gRPC Documentation</a> to familiarize yourself with some of the gRPC structures and patterns that are used in this SDK and tutorial.</p>
<h1>Project Setup</h1>
<p >The recommended build system for projects based on this SDK is <a href="https://cmake.org/"><code>cmake</code></a>. To include the SDK in your project , the simplest solution is to add a <code>FetchContent</code> block to your <code>CMakeLists.txt</code>. This approach will result in the compilation and linkage of the protobuff and gRPC dependencies locally.</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line">set(CMAKE_CXX_STANDARD 11)</div>
<div class="line"> </div>
<div class="line">include(FetchContent)</div>
<div class="line">FetchContent_Declare(sensorycloud</div>
<div class="line">    URL https://codeload.github.com/Sensory-Cloud/cpp-sdk/tar.gz/refs/tags/v1.0.4</div>
<div class="line">)</div>
<div class="line">FetchContent_MakeAvailable(sensorycloud)</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line"># Define an executable and link with libsensorycloud.</div>
<div class="line">add_executable(hello_world hello_world.cpp)</div>
<div class="line">target_link_libraries(hello_world PRIVATE sensorycloud)</div>
</div><!-- fragment --><h1>Configuring a connection</h1>
<h2>Endpoint Configuration</h2>
<p >To connect to your <a href="https://sensorycloud.ai/">SensoryCloud</a> Inference server, you will need to know:</p>
<ol type="1">
<li>the host-name or IP address that the service is running at,</li>
<li>the specific port that the service is running at &ndash; typically <code>443</code>, &ndash;</li>
<li>your tenant ID that uniquely identifies your tenant in SensoryCloud, and</li>
<li>a way of uniquely identifying devices in your application.</li>
</ol>
<p >This information can be provided to the SDK using a <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> object:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::Config config(</div>
<div class="line">    &quot;example.company.com&quot;,                   // the host name of the server</div>
<div class="line">    443,                                     // the port number of the service</div>
<div class="line">    &quot;a376234e-5b4b-4acb-bdbc-8cac8c397ace&quot;,  // your tenant ID</div>
<div class="line">    &quot;4e07cce1-cccb-4630-a2d1-5da71e3c85a3&quot;,  // a unique device ID</div>
<div class="line">    true                                     // a flag for enabling TLS</div>
<div class="line">);</div>
</div><!-- fragment --><p >A single instance of <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> should be instantiated and maintained per instance of an application on a device. Using multiple instances of <code><a class="el" href="classsensory_1_1_config.html" title="Configuration for a cloud endpoint.">sensory::Config</a></code> for the same remote host may result in undefined behavior.</p>
<h2>Device Registration</h2>
<p >Devices in your application will need to register and be authenticated using cross-device trust. As such, each device will need to provide the following information when instantiating the SDK:</p>
<ol type="1">
<li>A name for the device for identifying it among the cluster of devices,</li>
</ol>
<ol type="1">
<li>The type of device enrollment to use, e.g., <code>sharedSecret</code> if your fleet uses "passphrase"-based authentication or <code>JWT</code> to use JSON web tokens, and</li>
</ol>
<ol type="1">
<li>The value for the credential which varies depending on the device enrollment.</li>
</ol>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">sensory::RegistrationCredentials credentials(</div>
<div class="line">    &quot;Server 1&quot;,      // A human-readable name for the device.</div>
<div class="line">    &quot;sharedSecret&quot;,  // The type of enrollment (e.g., shared credential or JWT).</div>
<div class="line">    &quot;password&quot;       // The value of the credential.</div>
<div class="line">)</div>
</div><!-- fragment --><h2>Configuration &amp; Registration INI Files</h2>
<p >To simplify connection and device registration, the aforementioned information may be serialized in an INI file in the following format:</p>
<div class="fragment"><div class="line">[SDK-configuration]</div>
<div class="line">fullyQualifiedDomainName = example.company.com:443</div>
<div class="line">tenantID = a376234e-5b4b-4acb-bdbc-8cac8c397ace</div>
<div class="line">credential = password</div>
<div class="line">enrollmentType = sharedSecret</div>
<div class="line">deviceID = 4e07cce1-cccb-4630-a2d1-5da71e3c85a3</div>
<div class="line">deviceName = Server 1</div>
<div class="line">isSecure = 1</div>
</div><!-- fragment --><h2>Credential Storage</h2>
<p >The last thing you will need to set up for your application is a structure for storing credentials in a way that fits your security needs. <code>CredentialStore</code> provides the interface for credential storage that should be implemented for your specific usage.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">/// @brief A key-value interface for storing credentials, tokens, etc.</div>
<div class="line">struct CredentialStore {</div>
<div class="line">    /// @brief Emplace or replace a key/value pair in the credential store.</div>
<div class="line">    ///</div>
<div class="line">    /// @param key the plain-text key of the value to store</div>
<div class="line">    /// @param value the value to store</div>
<div class="line">    /// @details</div>
<div class="line">    /// Unlike most key-value store abstractions in the STL, this</div>
<div class="line">    /// implementation of emplace should overwrite existing values in the</div>
<div class="line">    /// key-value store.</div>
<div class="line">    ///</div>
<div class="line">    inline void emplace(const std::string&amp; key, const std::string&amp; value) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Return true if the key exists in the credential store.</div>
<div class="line">    ///</div>
<div class="line">    /// @param key the plain-text key to check for the existence of</div>
<div class="line">    ///</div>
<div class="line">    inline bool contains(const std::string&amp; key) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Look-up a secret value in the credential store.</div>
<div class="line">    ///</div>
<div class="line">    /// @param key the plain-text key of the value to return</div>
<div class="line">    /// @returns the secret value indexed by the given key</div>
<div class="line">    ///</div>
<div class="line">    inline std::string at(const std::string&amp; key) const;</div>
<div class="line"> </div>
<div class="line">    /// @brief Remove a secret key-value pair in the credential store.</div>
<div class="line">    ///</div>
<div class="line">    /// @param key the key of the pair to remove from the credential store</div>
<div class="line">    ///</div>
<div class="line">    inline void erase(const std::string&amp; key) const;</div>
<div class="line">};</div>
</div><!-- fragment --><p >Included with the SDK are an in-memory credential store <code><a class="el" href="structsensory_1_1token__manager_1_1_in_memory_credential_store.html" title="An in-memory credential store (mostly for testing purposes).">sensory::token_manager::InMemoryCredentialStore</a></code>, and a file-system based credential store <code><a class="el" href="classsensory_1_1token__manager_1_1_file_system_credential_store.html" title="A file-system–based credential storage manager.">sensory::token_manager::FileSystemCredentialStore</a></code> that may be useful for low-security applications, demonstration purposes, or debugging.</p>
<h2>SDK Instantiation</h2>
<p >With the data and structures from the previous steps, one can construct an instance of <code><a class="el" href="classsensory_1_1_sensory_cloud.html" title="The SensoryCloud service.">sensory::SensoryCloud</a></code> that provides access to each cloud service. The following example uses <code><a class="el" href="classsensory_1_1token__manager_1_1_file_system_credential_store.html" title="A file-system–based credential storage manager.">sensory::token_manager::FileSystemCredentialStore</a></code> as a credential store for demonstration purposes.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">FileSystemCredentialStore credential_store(&quot;.&quot;, &quot;com.company.cloud.debug&quot;);</div>
<div class="line">SensoryCloud&lt;FileSystemCredentialStore&gt;</div>
<div class="line">    cloud(config, credentials, credential_store);</div>
</div><!-- fragment --><p >As previously mentioned, config and registration credentials may optionally be stored in INI files and parsed on SDK initialization using the following:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">SensoryCloud&lt;FileSystemCredentialStore&gt; cloud(&quot;config.ini&quot;, ...);</div>
</div><!-- fragment --><h1>Checking The Server Health</h1>
<p >It's important to check the health of your <a href="https://sensorycloud.ai/">SensoryCloud</a> Inference server. You can do so using the <code>HealthService</code> via the following:</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">// Create a response for the RPC.</div>
<div class="line">sensory::api::common::ServerHealthResponse server_health;</div>
<div class="line">// Perform the RPC and check the status for errors.</div>
<div class="line">auto status = cloud.health.getHealth(&amp;server_health);</div>
<div class="line">if (!status.ok()) {  // The call failed, handle the error here.</div>
<div class="line">    auto errorCode = status.error_code();</div>
<div class="line">    auto errorMessage = status.error_message();</div>
<div class="line">} else {  // The call succeeded, handle the response here.</div>
<div class="line">    auto isHealthy = response.ishealthy();</div>
<div class="line">    auto serverVersion = response.serverversion();</div>
<div class="line">    auto serverID = response.id();</div>
<div class="line">}</div>
</div><!-- fragment --><h1>Example Projects</h1>
<p >The remainder of the tutorial is organized in a programmatic format through example code. Examples for each individual service may be found in the [examples](examples) directory. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.18-->
<!-- start footer part -->
</body>
</html>
